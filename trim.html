<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Trim Citation</title>
    <script src="https://cdn.staticfile.org/react/16.4.0/umd/react.development.js"></script>
    <script src="https://cdn.staticfile.org/react-dom/16.4.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"></script>
</head>

<body>
    <div id="example"></div>

    <script type="text/babel">


class Content extends React.Component {
    render() {
        return <div>
            <div style={inputStyle}>
                <textarea  value={this.props.orgText} onChange={this.props.updateStateProp} style={textareaStyle} />
            </div>
            <div style={outputStyle}>
                <textarea value={this.props.trimedText} style={textareaStyle} />
            </div>
        </div>;
    }
}
class HelloMessage extends React.Component {
    constructor(props) {
        super(props);
        this.state = { orgText:'', trimedText:'' };
        this.handleChange = this.handleChange.bind(this);
    }

    trimCitation(textIn) {
        while (textIn.indexOf('[') > 0 || textIn.indexOf(']') > 0) {
            let left = textIn.indexOf('[');
            let right = textIn.indexOf(']');
            if (left < 0 || right < 0) {
                let max = Math.max(left, right);
                left = right = max;
            }
            if (left > right) {
                [left, right] = [right, left];
            }
            let front = textIn.substring(0, left);
            let back = textIn.substring(right + 1, textIn.length);
            textIn = front + back;
        }
        return textIn;
    }

    handleChange(event) {
        let orgText = event.target.value;
        let trimedText = this.trimCitation(orgText);
        this.setState({ orgText: orgText,trimedText:trimedText });
    }
    render() {
        let orgText = this.state.orgText;
        let trimedText = this.state.trimedText;
        return <Content orgText={orgText} trimedText={trimedText} updateStateProp={this.handleChange}></Content>
    }
}
ReactDOM.render(
    <HelloMessage />,
    document.getElementById('example')
);

let inputStyle = {
    width: '49%',
    height: '-webkit-fill-available',
    float: 'left',
};

let outputStyle = {
    width: '49%',
    height: '-webkit-fill-available',
    float: 'right',
};

let textareaStyle = {
    width: '-webkit-fill-available',
    height: '-webkit-fill-available',
};


</script>

</body>

</html>